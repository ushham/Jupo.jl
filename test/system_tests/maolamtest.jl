using Test
using Jupo

@testset "qgs land atmosphere System" begin
    
    @testset "sys" begin
        @test maolam_2x2 isa System
    end

    @testset "upo NM" begin
        x_ic = x_ic = [0.07159900883680037,0.0070142018979509335,-0.0006102657944719442,1.3755555390351586e-14,2.636362853999812e-15,-3.5719918878355285e-15,-2.4418880766212857e-15,-1.6340354339084816e-14,0.054961961152423425,-0.013580168468217593,0.0693548817823575,0.005506870090217246,-0.0012214317606526791,-8.430622406517853e-15,1.0046535379074972e-14,-2.9015618303240757e-15,-9.330396383695027e-15,-5.228851312991052e-15,0.017885117713152966,-0.014396368074277086,0.320178234855473,0.009702416246217177,-0.002152009973744629,1.4649642903068035e-14,-5.42914505478004e-15,-9.67787310498645e-15,-1.1778224195639547e-14,-3.442228652471855e-15,-0.0014094094419068181,-0.001984547087313823, 38.78]
        x = upo = find_upo_nm(maolam_2x2, x_ic; min_norm=1e-10, damping_Î±=0.5, tensor_auto=true)

        @test x isa UPO_sol
        @test abs(x.period - 38.78977497694325) < 1e-8
    end
end